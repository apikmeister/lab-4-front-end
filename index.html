<!DOCTYPE html>
<html>
  <head>
    <title>Product Selection</title>
    <script>
      function getProductByChoice() {
        var selectElement = document.getElementById("productSelect");
        var selectedOption =
          selectElement.options[selectElement.selectedIndex].value;

        var xhr = new XMLHttpRequest();
        xhr.open(
          "GET",
          "getProductByChoice.php?choice=" + encodeURIComponent(selectedOption),
          true
        );
        xhr.onreadystatechange = function () {
          if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
            var responseData = JSON.parse(xhr.responseText);
            displayData(responseData);
          }
        };
        xhr.send();
      }

      function displayData(data) {
        var table = document.createElement("table");
        var headerRow = document.createElement("tr");

        for (var key in data[0]) {
          var headerCell = document.createElement("th");
          headerCell.textContent = key;
          headerRow.appendChild(headerCell);
        }
        table.appendChild(headerRow);

        var displayArea = document.getElementById("displayArea");
        displayArea.innerHTML = "";
        displayArea.appendChild(table);

        var currentIndex = 0;
        var interval = setInterval(function () {
          if (currentIndex < data.length) {
            var rowData = data[currentIndex];
            var row = document.createElement("tr");

            for (var key in rowData) {
              var cell = document.createElement("td");
              cell.textContent = rowData[key];
              row.appendChild(cell);
            }
            table.appendChild(row);

            currentIndex++;
          } else {
            clearInterval(interval);
          }
        }, 500);
      }
    </script>
  </head>
  <body>
    <h1>Product Selection</h1>

    <script>
      function getProductLine() {
        var xhttp;
        xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("demo2").innerHTML = this.responseText;
          }
        };
        xhttp.open("GET", "readproductline.php", true);
        xhttp.send();
      }
      getProductLine();
    </script>

    <br /><br />

    <button onclick="getProductByChoice()">Get Products</button>

    <div id="displayArea"></div>
  </body>
</html>
